"0","df.estabelacimento.bruto <- read.csv(""estabelecimentos.txt"", sep = "";"", dec = "","","
"0","                                     colClasses = c(""CNPJ_BASICO"" = ""character"", ""CNPJ_ORDEM"" = ""character"", ""CNPJ_DV"" = ""character"","
"0","                                                    ""IDENTIFICADOR_MF"" = ""integer"", ""NOME_FANTASIA"" = ""character"", ""SITUACAO"" = ""integer"","
"0","                                                    ""DATA_SITUACAO"" = ""character"", ""MOTIVO_SITUACAO"" = ""integer"", ""CIDADE_EXT"" = ""character"","
"0","                                                    ""PAIS"" = ""integer"", ""DATA_ATIVIDADE"" = ""character"", ""CNAE_PRINCIPAL"" = ""integer"","
"0","                                                    ""CNAE_SECUNDARIO"" = ""character"", ""TIPO_LOG"" = ""character"", ""LOGRADOURO"" = ""character"","
"0","                                                    ""NUMERO"" = ""character"", ""COMPLEMENTO"" = ""character"", ""BAIRRO"" = ""character"","
"0","                                                    ""CEP"" = ""character"", ""UF"" = ""factor"", ""MUNICIPIO"" = ""integer"","
"0","                                                    ""DDD1"" = ""character"", ""TELEFONE1"" = ""character"", ""DDD2"" = ""character"","
"0","                                                    ""TELEFONE2"" = ""character"", ""DDD_FAX"" = ""character"", ""FAX"" = ""character"","
"0","                                                    ""EMAIL"" = ""character"", ""SITUACAO_ESPECIAL"" = ""character"", ""DATA_SITUACAO_ESPECIAL"" = ""integer"","
"0","                                                    ""RAZAO_SOCIAL"" = ""character"", ""NATUREZA"" = ""integer"", ""QUALICACAO_RESPONSAVEL"" = ""integer"","
"0","                                                    ""CAPITAL"" = ""numeric"", ""PORTE"" = ""integer"", ""ENTE_FED_RESPONSAVEL"" = ""character"""
"0","                                     ))"
"0",""
"0","df.estabelacimento <- df.estabelacimento.bruto %>%"
"0","  transmute("
"0","    cnpj = paste0(CNPJ_BASICO, CNPJ_ORDEM, CNPJ_DV),"
"0","    nome = NOME_FANTASIA,"
"0","    tipo = if_else(.$IDENTIFICADOR_MF == 1, 'MATRIZ',"
"0","                   if_else(.$IDENTIFICADOR_MF == 2, 'FILIAL', NULL)),"
"0","    situacao = if_else(.$SITUACAO == 1, ""NULA"","
"0","                       if_else(.$SITUACAO == 2, ""ATIVA"","
"0","                               if_else(.$SITUACAO == 3, ""SUSPENSA"","
"0","                                       if_else(.$SITUACAO == 4, ""INAPTA"","
"0","                                               if_else(.$SITUACAO == 8, ""BAIXADA"","
"0","                                                       NULL))))),"
"0","    dataSituacao = .$DATA_SITUACAO %>% as.Date(format = ""%Y%m%d""),"
"0","    dataAtividade = .$DATA_ATIVIDADE %>% as.Date(format = ""%Y%m%d""),"
"0","    cnaePrincipal = .$CNAE_PRINCIPAL,"
"0","    cnaeSecundario = .$CNAE_SECUNDARIO %>% str_split("",""),"
"0","    endereco = paste0(.$TIPO_LOG, "" "", .$LOGRADOURO, "", "", .$COMPLEMENTO, "" "", .$NUMERO, "" - "","
"0","                      .$BAIRRO, "", TERESINA - PI, ""),"
"0","    cep = CEP,"
"0","    razaoSociao = RAZAO_SOCIAL,"
"0","    capital = CAPITAL,"
"0","    porte = if_else(.$PORTE == 0, ""NÃ‚O INFORMADO"","
"0","                    if_else(.$PORTE == 1, ""MICRO EMPRESA"","
"0","                            if_else(.$PORTE == 3, ""PEQUENO PORTE"","
"0","                                    if_else(.$PORTE == 5, ""DEMAIS"", NULL))))"
"0","  )"
"0",""
"0","df.estabelacimento <- df.estabelacimento %>% add_column("
"0","  cnaes = mapply(list, .$cnaePrincipal, .$cnaeSecundario, SIMPLIFY = F) %>% map(unlist)"
"0",")"
